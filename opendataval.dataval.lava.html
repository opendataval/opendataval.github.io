<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="opendataval.dataval.margcontrib package" href="opendataval.dataval.margcontrib.html" /><link rel="prev" title="opendataval.dataval.knnshap package" href="opendataval.dataval.knnshap.html" />

    <link rel="shortcut icon" href="_static/favicon.ico"/><!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>opendataval.dataval.lava package - OpenDataVal documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">OpenDataVal  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo-light-mode.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo-dark-mode.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">OpenDataVal  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="modules.html">modules</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="opendataval.html">opendataval package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of opendataval package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="opendataval.dataloader.html">opendataval.dataloader package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of opendataval.dataloader package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="opendataval.dataloader.datasets.html">opendataval.dataloader.datasets package</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of opendataval.dataloader.datasets package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="generated/opendataval.dataloader.datasets.datasets.html">opendataval.dataloader.datasets.datasets</a></li>
<li class="toctree-l5"><a class="reference internal" href="generated/opendataval.dataloader.datasets.imagesets.html">opendataval.dataloader.datasets.imagesets</a></li>
<li class="toctree-l5"><a class="reference internal" href="generated/opendataval.dataloader.datasets.nlpsets.html">opendataval.dataloader.datasets.nlpsets</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataloader.Register.html">opendataval.dataloader.Register</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataloader.DataFetcher.html">opendataval.dataloader.DataFetcher</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="generated/opendataval.dataloader.datasets.html">opendataval.dataloader.datasets</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of opendataval.dataloader.datasets</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="generated/generated/opendataval.dataloader.datasets.datasets.html">opendataval.dataloader.datasets.datasets</a></li>
<li class="toctree-l5"><a class="reference internal" href="generated/generated/opendataval.dataloader.datasets.imagesets.html">opendataval.dataloader.datasets.imagesets</a></li>
<li class="toctree-l5"><a class="reference internal" href="generated/generated/opendataval.dataloader.datasets.nlpsets.html">opendataval.dataloader.datasets.nlpsets</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataloader.cache.html">opendataval.dataloader.cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataloader.mix_labels.html">opendataval.dataloader.mix_labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataloader.one_hot_encode.html">opendataval.dataloader.one_hot_encode</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataloader.CatDataset.html">opendataval.dataloader.CatDataset</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="opendataval.dataval.html">opendataval.dataval package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of opendataval.dataval package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="opendataval.dataval.ame.html">opendataval.dataval.ame package</a></li>
<li class="toctree-l4"><a class="reference internal" href="opendataval.dataval.csshap.html">opendataval.dataval.csshap package</a></li>
<li class="toctree-l4"><a class="reference internal" href="opendataval.dataval.dvrl.html">opendataval.dataval.dvrl package</a></li>
<li class="toctree-l4"><a class="reference internal" href="opendataval.dataval.influence.html">opendataval.dataval.influence package</a></li>
<li class="toctree-l4"><a class="reference internal" href="opendataval.dataval.knnshap.html">opendataval.dataval.knnshap package</a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">opendataval.dataval.lava package</a></li>
<li class="toctree-l4"><a class="reference internal" href="opendataval.dataval.margcontrib.html">opendataval.dataval.margcontrib package</a></li>
<li class="toctree-l4"><a class="reference internal" href="opendataval.dataval.oob.html">opendataval.dataval.oob package</a></li>
<li class="toctree-l4"><a class="reference internal" href="opendataval.dataval.random.html">opendataval.dataval.random package</a></li>
<li class="toctree-l4"><a class="reference internal" href="opendataval.dataval.volume.html">opendataval.dataval.volume package</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.DataEvaluator.html">opendataval.dataval.DataEvaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.ModelMixin.html">opendataval.dataval.ModelMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.ModelLessMixin.html">opendataval.dataval.ModelLessMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.AME.html">opendataval.dataval.AME</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.DVRL.html">opendataval.dataval.DVRL</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.InfluenceFunction.html">opendataval.dataval.InfluenceFunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.InfluenceSubsample.html">opendataval.dataval.InfluenceSubsample</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.KNNShapley.html">opendataval.dataval.KNNShapley</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.DataOob.html">opendataval.dataval.DataOob</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.DataBanzhaf.html">opendataval.dataval.DataBanzhaf</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.BetaShapley.html">opendataval.dataval.BetaShapley</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.DataShapley.html">opendataval.dataval.DataShapley</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.LavaEvaluator.html">opendataval.dataval.LavaEvaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.LeaveOneOut.html">opendataval.dataval.LeaveOneOut</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.ShapEvaluator.html">opendataval.dataval.ShapEvaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.RandomEvaluator.html">opendataval.dataval.RandomEvaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.RobustVolumeShapley.html">opendataval.dataval.RobustVolumeShapley</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.Sampler.html">opendataval.dataval.Sampler</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.TMCSampler.html">opendataval.dataval.TMCSampler</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.dataval.GrTMCSampler.html">opendataval.dataval.GrTMCSampler</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="opendataval.experiment.html">opendataval.experiment package</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of opendataval.experiment package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.experiment.ExperimentMediator.html">opendataval.experiment.ExperimentMediator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.experiment.exper_methods.html">opendataval.experiment.exper_methods</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="opendataval.model.html">opendataval.model package</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of opendataval.model package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.model.Model.html">opendataval.model.Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.model.GradientModel.html">opendataval.model.GradientModel</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.model.ModelFactory.html">opendataval.model.ModelFactory</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.model.TorchClassMixin.html">opendataval.model.TorchClassMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.model.TorchRegressMixin.html">opendataval.model.TorchRegressMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.model.TorchPredictMixin.html">opendataval.model.TorchPredictMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.model.TorchGradMixin.html">opendataval.model.TorchGradMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.model.ClassifierSkLearnWrapper.html">opendataval.model.ClassifierSkLearnWrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.model.ClassifierUnweightedSkLearnWrapper.html">opendataval.model.ClassifierUnweightedSkLearnWrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/opendataval.model.RegressionSkLearnWrapper.html">opendataval.model.RegressionSkLearnWrapper</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="generated/opendataval.dataloader.html">opendataval.dataloader</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of opendataval.dataloader</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataloader.Register.html">opendataval.dataloader.Register</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataloader.DataFetcher.html">opendataval.dataloader.DataFetcher</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="generated/generated/opendataval.dataloader.datasets.html">opendataval.dataloader.datasets</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of opendataval.dataloader.datasets</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="generated/generated/generated/opendataval.dataloader.datasets.datasets.html">opendataval.dataloader.datasets.datasets</a></li>
<li class="toctree-l5"><a class="reference internal" href="generated/generated/generated/opendataval.dataloader.datasets.imagesets.html">opendataval.dataloader.datasets.imagesets</a></li>
<li class="toctree-l5"><a class="reference internal" href="generated/generated/generated/opendataval.dataloader.datasets.nlpsets.html">opendataval.dataloader.datasets.nlpsets</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataloader.cache.html">opendataval.dataloader.cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataloader.mix_labels.html">opendataval.dataloader.mix_labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataloader.one_hot_encode.html">opendataval.dataloader.one_hot_encode</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataloader.CatDataset.html">opendataval.dataloader.CatDataset</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="generated/opendataval.dataval.html">opendataval.dataval</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of opendataval.dataval</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.DataEvaluator.html">opendataval.dataval.DataEvaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.ModelMixin.html">opendataval.dataval.ModelMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.ModelLessMixin.html">opendataval.dataval.ModelLessMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.AME.html">opendataval.dataval.AME</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.DVRL.html">opendataval.dataval.DVRL</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.InfluenceFunction.html">opendataval.dataval.InfluenceFunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.InfluenceSubsample.html">opendataval.dataval.InfluenceSubsample</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.KNNShapley.html">opendataval.dataval.KNNShapley</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.DataOob.html">opendataval.dataval.DataOob</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.DataBanzhaf.html">opendataval.dataval.DataBanzhaf</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.BetaShapley.html">opendataval.dataval.BetaShapley</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.DataShapley.html">opendataval.dataval.DataShapley</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.LavaEvaluator.html">opendataval.dataval.LavaEvaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.LeaveOneOut.html">opendataval.dataval.LeaveOneOut</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.ShapEvaluator.html">opendataval.dataval.ShapEvaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.RandomEvaluator.html">opendataval.dataval.RandomEvaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.RobustVolumeShapley.html">opendataval.dataval.RobustVolumeShapley</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.Sampler.html">opendataval.dataval.Sampler</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.TMCSampler.html">opendataval.dataval.TMCSampler</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.dataval.GrTMCSampler.html">opendataval.dataval.GrTMCSampler</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="generated/opendataval.model.html">opendataval.model</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of opendataval.model</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.model.Model.html">opendataval.model.Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.model.GradientModel.html">opendataval.model.GradientModel</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.model.ModelFactory.html">opendataval.model.ModelFactory</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.model.TorchClassMixin.html">opendataval.model.TorchClassMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.model.TorchRegressMixin.html">opendataval.model.TorchRegressMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.model.TorchPredictMixin.html">opendataval.model.TorchPredictMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.model.TorchGradMixin.html">opendataval.model.TorchGradMixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.model.ClassifierSkLearnWrapper.html">opendataval.model.ClassifierSkLearnWrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.model.ClassifierUnweightedSkLearnWrapper.html">opendataval.model.ClassifierUnweightedSkLearnWrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.model.RegressionSkLearnWrapper.html">opendataval.model.RegressionSkLearnWrapper</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="generated/opendataval.experiment.html">opendataval.experiment</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of opendataval.experiment</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.experiment.ExperimentMediator.html">opendataval.experiment.ExperimentMediator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/opendataval.experiment.exper_methods.html">opendataval.experiment.exper_methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/opendataval.util.set_random_state.html">opendataval.util.set_random_state</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/opendataval.util.load_mediator_output.html">opendataval.util.load_mediator_output</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/opendataval.__version__.html">opendataval.__version__</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="leaderboards.html">leaderboards</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">license</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="opendataval-dataval-lava-package">
<h1>opendataval.dataval.lava package<a class="headerlink" href="#opendataval-dataval-lava-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-opendataval.dataval.lava.lava">
<span id="opendataval-dataval-lava-lava-module"></span><h2>opendataval.dataval.lava.lava module<a class="headerlink" href="#module-opendataval.dataval.lava.lava" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="opendataval.dataval.lava.lava.LavaEvaluator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">opendataval.dataval.lava.lava.</span></span><span class="sig-name descname"><span class="pre">LavaEvaluator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#opendataval.dataval.lava.lava.LavaEvaluator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="opendataval.dataval.html#opendataval.dataval.api.DataEvaluator" title="opendataval.dataval.api.DataEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataEvaluator</span></code></a>, <a class="reference internal" href="opendataval.dataval.html#opendataval.dataval.api.ModelLessMixin" title="opendataval.dataval.api.ModelLessMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelLessMixin</span></code></a></p>
<p>Data valuation using LAVA implementation.</p>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id1" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>H. A. Just, F. Kang, T. Wang, Y. Zeng, M. Ko, M. Jin, and R. Jia,
LAVA: Data Valuation without Pre-Specified Learning Algorithms,
2023. Available: <a class="reference external" href="https://openreview.net/forum?id=JJuP86nBl4q">https://openreview.net/forum?id=JJuP86nBl4q</a></p>
</aside>
</aside>
</section>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>device<span class="classifier">torch.device, optional</span></dt><dd><p>Tensor device for acceleration, by default torch.device(“cpu”)</p>
</dd>
<dt>random_state: RandomState, optional</dt><dd><p>Random initial state, by default None</p>
</dd>
</dl>
</section>
<section id="mixins">
<h3>Mixins<a class="headerlink" href="#mixins" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>ModelLessMixin</dt><dd><p>Mixin for a data evaluator that doesn’t require a model or evaluation metric.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="opendataval.dataval.lava.lava.LavaEvaluator.evaluate_data_values">
<span class="sig-name descname"><span class="pre">evaluate_data_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#opendataval.dataval.lava.lava.LavaEvaluator.evaluate_data_values" title="Link to this definition">#</a></dt>
<dd><p>Return data values for each training data point.</p>
<p>Gets the calibrated gradient of the dual solution, which can be interpreted as
the data values.</p>
<section id="returns">
<h4>Returns<a class="headerlink" href="#returns" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>np.ndarray</dt><dd><p>Predicted data values/selection for training input data point</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="opendataval.dataval.lava.lava.LavaEvaluator.train_data_values">
<span class="sig-name descname"><span class="pre">train_data_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#opendataval.dataval.lava.lava.LavaEvaluator.train_data_values" title="Link to this definition">#</a></dt>
<dd><p>Trains model to predict data values.</p>
<p>Computes the class-wise Wasserstein distance between the training and the
validation set.</p>
<section id="id2">
<h4>References<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id3" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>H. A. Just, F. Kang, T. Wang, Y. Zeng, M. Ko, M. Jin, and R. Jia,
LAVA: Data Valuation without Pre-Specified Learning Algorithms,
2023. Available: <a class="reference external" href="https://openreview.net/forum?id=JJuP86nBl4q">https://openreview.net/forum?id=JJuP86nBl4q</a></p>
</aside>
<aside class="footnote brackets" id="id4" role="note">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>D. Alvarez-Melis and N. Fusi,
Geometric Dataset Distances via Optimal Transport,
arXiv.org, 2020. Available: <a class="reference external" href="https://arxiv.org/abs/2002.02923">https://arxiv.org/abs/2002.02923</a>.</p>
</aside>
<aside class="footnote brackets" id="id5" role="note">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>D. Alvarez-Melis and N. Fusi,
Dataset Dynamics via Gradient Flows in Probability Space,
arXiv.org, 2020. Available: <a class="reference external" href="https://arxiv.org/abs/2010.12760">https://arxiv.org/abs/2010.12760</a>.</p>
</aside>
</aside>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="opendataval.dataval.lava.lava.macos_fix">
<span class="sig-prename descclassname"><span class="pre">opendataval.dataval.lava.lava.</span></span><span class="sig-name descname"><span class="pre">macos_fix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#opendataval.dataval.lava.lava.macos_fix" title="Link to this definition">#</a></dt>
<dd><p>Geomloss package has a bug on MacOS remedied as follows.</p>
<p><a href="#id18"><span class="problematic" id="id19">`Link to similar bug: https://github.com/NVlabs/stylegan3/issues/75`_</span></a>.</p>
</dd></dl>

</section>
<section id="module-opendataval.dataval.lava.otdd">
<span id="opendataval-dataval-lava-otdd-module"></span><h2>opendataval.dataval.lava.otdd module<a class="headerlink" href="#module-opendataval.dataval.lava.otdd" title="Link to this heading">#</a></h2>
<p>Main module for computing exact wasserstein distance between two data sets.</p>
<p><a class="reference external" href="https://github.com/microsoft/otdd">OTDD Repository</a>.</p>
<section id="id6">
<h3>References<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<blockquote>
<div><aside class="footnote brackets" id="id7" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>D. Alvarez-Melis and N. Fusi,
Geometric Dataset Distances via Optimal Transport,
arXiv.org, 2020. Available: <a class="reference external" href="https://arxiv.org/abs/2002.02923">https://arxiv.org/abs/2002.02923</a>.</p>
</aside>
<aside class="footnote brackets" id="id8" role="note">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>D. Alvarez-Melis and N. Fusi,
Dataset Dynamics via Gradient Flows in Probability Space,
arXiv.org, 2020. Available: <a class="reference external" href="https://arxiv.org/abs/2010.12760">https://arxiv.org/abs/2010.12760</a>.</p>
</aside>
<aside class="footnote brackets" id="id9" role="note">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://github.com/microsoft/otdd">OTDD repo</a>.
The following implementation was taken from this repository. It is intended as a
strict subset of the options provided in the repository, only computing the
class-wise Wasserstein as needed by the LAVA Paper by H.A. Just et al.</p>
</aside>
</aside>
</div></blockquote>
<dl class="simple">
<dt>Legacy notation:</dt><dd><p>X1, X2: feature tensors of the two datasets
Y1, Y2: label tensors of the two datasets
N1, N2 (or N,M): number of samples in datasets
D1, D2: (feature) dimension of the datasets
C1, C2: number of classes in the datasets</p>
</dd>
</dl>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="opendataval.dataval.lava.otdd.DatasetDistance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">opendataval.dataval.lava.otdd.</span></span><span class="sig-name descname"><span class="pre">DatasetDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_valid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_valid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_cost</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'euclidean'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entreg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_ot_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sinkhorn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_ot_debiased</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_ot_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_ot_entreg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#opendataval.dataval.lava.otdd.DatasetDistance" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The main class for the Optimal Transport Dataset Distance.</p>
<p>An object of this class is instantiated with two datasets (the source and
target), which are stored in it, and various arguments determining how the
exact Wasserstein distance is to be computed.</p>
<section id="id10">
<h3>Parameters<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>x_train<span class="classifier">torch.Tensor</span></dt><dd><p>Covariates of the first distribution</p>
</dd>
<dt>y_train<span class="classifier">torch.Tensor</span></dt><dd><p>Labels of the first distribution</p>
</dd>
<dt>x_valid<span class="classifier">torch.Tensor</span></dt><dd><p>Covariates of the second/validation distribution</p>
</dd>
<dt>y_valid<span class="classifier">torch.Tensor</span></dt><dd><p>Labels of the second/validation distribution</p>
</dd>
<dt>feature_cost<span class="classifier">Literal[“euclidean”] | Callable, optional</span></dt><dd><p>If not ‘euclidean’, must be a callable that implements a cost function
between feature vectors, by default “euclidean”</p>
</dd>
<dt>p<span class="classifier">int, optional</span></dt><dd><p>The coefficient in the OT cost (i.e., the p in p-Wasserstein), by default 2</p>
</dd>
<dt>entreg<span class="classifier">float, optional</span></dt><dd><p>The strength of entropy regularization for sinkhorn, by default 0.1</p>
</dd>
<dt>lam_x<span class="classifier">float, optional</span></dt><dd><p>Weight parameter for feature component of distance, by default 1.0</p>
</dd>
<dt>lam_y<span class="classifier">float, optional</span></dt><dd><p>Weight parameter for label component of distance.=, by default 1.0</p>
</dd>
<dt>inner_ot_loss<span class="classifier">str, optional</span></dt><dd><p>Loss type to exact OT problem, by default “sinkhorn”</p>
</dd>
<dt>inner_ot_debiased<span class="classifier">bool, optional</span></dt><dd><p>Whether to use the debiased version of sinkhorn in the inner OT problem,
by default False</p>
</dd>
<dt>inner_ot_p<span class="classifier">int, optional</span></dt><dd><p>The coefficient in the inner OT cost., by default 2</p>
</dd>
<dt>inner_ot_entreg<span class="classifier">float, optional</span></dt><dd><p>The strength of entropy regularization for sinkhorn in the inner OT problem,
by default 0.1</p>
</dd>
<dt>device<span class="classifier">torch.device, optional</span></dt><dd><p>Tensor device for acceleration, by default torch.device(“cpu”)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="opendataval.dataval.lava.otdd.DatasetDistance.dual_sol">
<span class="sig-name descname"><span class="pre">dual_sol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#opendataval.dataval.lava.otdd.DatasetDistance.dual_sol" title="Link to this definition">#</a></dt>
<dd><p>Compute dataset distance.</p>
<dl class="simple">
<dt>Note:</dt><dd><p>Currently requires fully loading dataset into memory, this can probably be
avoided, e.g., via subsampling.</p>
</dd>
</dl>
<section id="id11">
<h4>Returns<a class="headerlink" href="#id11" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>tuple[float, torch.Tensor]</dt><dd><p>dist (float): the optimal transport dataset distance value.
pi (tensor, optional): the optimal transport coupling.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="opendataval.dataval.lava.otdd.FeatureCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">opendataval.dataval.lava.otdd.</span></span><span class="sig-name descname"><span class="pre">FeatureCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tgt_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tgt_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#opendataval.dataval.lava.otdd.FeatureCost" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class implementing a cost (or distance) between feature vectors.</p>
<dl>
<dt>Arguments:</dt><dd><p>p (int): the coefficient in the OT cost (i.e., the p in p-Wasserstein).
src_embedding (callable, optional): if provided, source data will be</p>
<blockquote>
<div><p>embedded using this function prior to distance computation.</p>
</div></blockquote>
<dl class="simple">
<dt>tgt_embedding (callable, optional): if provided, target data will be</dt><dd><p>embedded using this function prior to distance computation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="opendataval.dataval.lava.otdd.batch_augmented_cost">
<span class="sig-prename descclassname"><span class="pre">opendataval.dataval.lava.otdd.</span></span><span class="sig-name descname"><span class="pre">batch_augmented_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_cost</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#opendataval.dataval.lava.otdd.batch_augmented_cost" title="Link to this definition">#</a></dt>
<dd><p>Batch ground cost computation on augmented datasets.</p>
<section id="id12">
<h3>Parameters<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>Z1<span class="classifier">torch.Tensor</span></dt><dd><p>Tensor of size (B,N,D1), where last position in last dim corresponds to label Y.</p>
</dd>
<dt>Z2<span class="classifier">torch.Tensor</span></dt><dd><p>Tensor of size (B,M,D2), where last position in last dim corresponds to label Y.</p>
</dd>
<dt>W<span class="classifier">torch.Tensor, optional</span></dt><dd><p>Tensor of size (V1,V2) of precomputed pairwise label distances for all labels
V1,V2 and returns a batched cost matrix as a (B,N,M) Tensor. W is expected to be
congruent with p. I.e, if p=2, W[i,j] should be squared Wasserstein distance.,
by default None</p>
</dd>
<dt>feature_cost<span class="classifier">str, optional</span></dt><dd><p>if None or ‘euclidean’, uses euclidean distances as feature metric,
otherwise uses this function as metric., by default None</p>
</dd>
<dt>p<span class="classifier">int, optional</span></dt><dd><p>Power of the cost (i.e. order of p-Wasserstein distance), by default 2</p>
</dd>
<dt>lam_x<span class="classifier">float, optional</span></dt><dd><p>Weight parameter for feature component of distance, by default 1.0</p>
</dd>
<dt>lam_y<span class="classifier">float, optional</span></dt><dd><p>Weight parameter for label component of distance, by default 1.0</p>
</dd>
</dl>
</section>
<section id="id13">
<h3>Returns<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>torch Tensor of size (B,N,M)</p>
</dd>
</dl>
</section>
<section id="raises">
<h3>Raises<a class="headerlink" href="#raises" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>ValueError</dt><dd><p>If W is not provided</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="opendataval.dataval.lava.otdd.extract_dataset">
<span class="sig-prename descclassname"><span class="pre">opendataval.dataval.lava.otdd.</span></span><span class="sig-name descname"><span class="pre">extract_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reindex_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#opendataval.dataval.lava.otdd.extract_dataset" title="Link to this definition">#</a></dt>
<dd><p>Loads full dataset into memory and reindexes the labels.</p>
<section id="id14">
<h3>Parameters<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>x_input<span class="classifier">Dataset | torch.Tensor</span></dt><dd><p>Covariate Dataset/tensor to be loaded</p>
</dd>
<dt>y_input<span class="classifier">Dataset | torch.Tensor</span></dt><dd><p>Label Dataset/tensor to be loaded</p>
</dd>
<dt>batch_size<span class="classifier">int, optional</span></dt><dd><p>Batch size of data to be loaded at a time, by default 256</p>
</dd>
<dt>reindex_start<span class="classifier">int, optional</span></dt><dd><p>How much to offset the labels by, useful when comparing different
data sets so that the data have different labels, by default 0</p>
</dd>
</dl>
</section>
<section id="id15">
<h3>Returns<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>tuple[torch.Tensor, torch.Tensor]</dt><dd><p><strong>x_tensor</strong> Covariates stacked along first dimension
<strong>y_tensor</strong> Labels, no longer in one-hot-encoding and offset by reindex_start</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="opendataval.dataval.lava.otdd.pwdist_exact">
<span class="sig-prename descclassname"><span class="pre">opendataval.dataval.lava.otdd.</span></span><span class="sig-name descname"><span class="pre">pwdist_exact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sinkhorn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'euclidean'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entreg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#opendataval.dataval.lava.otdd.pwdist_exact" title="Link to this definition">#</a></dt>
<dd><p>Computation of pairwise Wasserstein distances.</p>
<p>Efficient computation of pairwise label-to-label Wasserstein distances
between multiple distributions, without using Gaussian assumption.</p>
<section id="id16">
<h3>Parameters<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>X1<span class="classifier">torch.Tensor</span></dt><dd><p>Covariates of first distribution</p>
</dd>
<dt>Y1<span class="classifier">torch.Tensor</span></dt><dd><p>Labels of first distribution</p>
</dd>
<dt>X2<span class="classifier">torch.Tensor, optional</span></dt><dd><p>Covariates of second distribution, if None distributions are treated as same,
by default None</p>
</dd>
<dt>Y2<span class="classifier">torch.Tensor, optional</span></dt><dd><p>Labels of second distribution, iif None distributions are treated as same,
by default None</p>
</dd>
<dt>symmetric<span class="classifier">bool, optional</span></dt><dd><p>Whether X1/Y1 and X2/Y2 are to be treated as the same dataset, by default False</p>
</dd>
<dt>loss<span class="classifier">str, optional</span></dt><dd><p>The loss function to compute.  Sinkhorn divergence, which interpolates between
(blur=0) and kernel (blur= <span class="math notranslate nohighlight">\(+\infty\)</span> ) distances., by default “sinkhorn”</p>
</dd>
<dt>cost_function<span class="classifier">: Literal[“euclidean”] | Callable[…, torch.Tensor], optional</span></dt><dd><p>Cost function that should be used instead of <span class="math notranslate nohighlight">\(\tfrac{1}{p}\|x-y\|^p\)</span>,
by default “euclidean”</p>
</dd>
<dt>p<span class="classifier">int, optional</span></dt><dd><p>power of the cost (i.e. order of p-Wasserstein distance), by default 2</p>
</dd>
<dt>debias<span class="classifier">bool, optional</span></dt><dd><p>If true, uses debiased sinkhorn divergence., by default True</p>
</dd>
<dt>entreg<span class="classifier">float, optional</span></dt><dd><p>The strength of entropy regularization for sinkhorn., by default 1e-1</p>
</dd>
<dt>device<span class="classifier">torch.device, optional</span></dt><dd><p>Tensor device for acceleration, by default torch.device(“cpu”)</p>
</dd>
</dl>
</section>
<section id="id17">
<h3>Returns<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>Computed Wasserstein distance</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-opendataval.dataval.lava">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-opendataval.dataval.lava" title="Link to this heading">#</a></h2>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="opendataval.dataval.margcontrib.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">opendataval.dataval.margcontrib package</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="opendataval.dataval.knnshap.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">opendataval.dataval.knnshap package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, OpenDataVal
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">opendataval.dataval.lava package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-opendataval.dataval.lava.lava">opendataval.dataval.lava.lava module</a><ul>
<li><a class="reference internal" href="#opendataval.dataval.lava.lava.LavaEvaluator"><code class="docutils literal notranslate"><span class="pre">LavaEvaluator</span></code></a><ul>
<li><a class="reference internal" href="#opendataval.dataval.lava.lava.LavaEvaluator.evaluate_data_values"><code class="docutils literal notranslate"><span class="pre">LavaEvaluator.evaluate_data_values()</span></code></a></li>
<li><a class="reference internal" href="#opendataval.dataval.lava.lava.LavaEvaluator.train_data_values"><code class="docutils literal notranslate"><span class="pre">LavaEvaluator.train_data_values()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#opendataval.dataval.lava.lava.macos_fix"><code class="docutils literal notranslate"><span class="pre">macos_fix()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-opendataval.dataval.lava.otdd">opendataval.dataval.lava.otdd module</a><ul>
<li><a class="reference internal" href="#id6">References</a></li>
<li><a class="reference internal" href="#opendataval.dataval.lava.otdd.DatasetDistance"><code class="docutils literal notranslate"><span class="pre">DatasetDistance</span></code></a><ul>
<li><a class="reference internal" href="#opendataval.dataval.lava.otdd.DatasetDistance.dual_sol"><code class="docutils literal notranslate"><span class="pre">DatasetDistance.dual_sol()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#opendataval.dataval.lava.otdd.FeatureCost"><code class="docutils literal notranslate"><span class="pre">FeatureCost</span></code></a></li>
<li><a class="reference internal" href="#opendataval.dataval.lava.otdd.batch_augmented_cost"><code class="docutils literal notranslate"><span class="pre">batch_augmented_cost()</span></code></a></li>
<li><a class="reference internal" href="#opendataval.dataval.lava.otdd.extract_dataset"><code class="docutils literal notranslate"><span class="pre">extract_dataset()</span></code></a></li>
<li><a class="reference internal" href="#opendataval.dataval.lava.otdd.pwdist_exact"><code class="docutils literal notranslate"><span class="pre">pwdist_exact()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-opendataval.dataval.lava">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=7f41d439"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>